<xf:macro name="snippet"
		  arg-user="!"
		  arg-message="!"
		  arg-type="!"
		  arg-context="!"
		  >

	<xf:if is="$user.canReceiveFullEmailMessageContent()">
		<xf:if is="$xf.options.FMP_TextTrimLengthFull < 0">
			<div class="message">{{ bb_code_type('emailHtml', $message, $type, $context) }}</div>
		<xf:elseif is="$xf.options.FMP_TextTrimLengthFull > 0" />
			<div class="message">{{ bb_code_type('emailHtml', snippet($message, $xf.options.FMP_TextTrimLengthFull), $type, $context) }}</div>
		</xf:if>
	<xf:else />
		<xf:if is="$xf.options.FMP_TextTrimLength < 0">
			<div class="message">{{ bb_code_type('emailHtml', $message, $type, $context) }}</div>
		<xf:elseif is="$xf.options.FMP_TextTrimLength > 0" />
			<div class="message">{{ bb_code_type('emailHtml', snippet($message, $xf.options.FMP_TextTrimLength), $type, $context) }}</div>
		</xf:if>
	</xf:if>
</xf:macro>